<!DOCTYPE html><html lang="en" prefix="og: http://ogp.me/ns#"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'none'"><title>TypeScript Tips and Tricks - Utility Types With Examples</title><meta property="og:title" content="TypeScript Tips and Tricks - Utility Types With Examples"><meta name="description" content="In this article we will learn how to use utility types, create types based on objects or tupples, transform types and override properties in TypeScript without copy-paste "><meta property="og:description" content="In this article we will learn how to use utility types, create types based on objects or tupples, transform types and override properties in TypeScript without copy-paste "><meta name="keywords" content="typescript, utility types, custom types, keyof, as const, infer, partial, omit, transform"><link rel="canonical" href="https://drag13.io/posts/typescript-tricks-utility-examples/index.html"><meta property="og:url" content="https://drag13.io/posts/typescript-tricks-utility-examples/index.html"><meta property="og:type" content="website"><meta name="twitter:card" content="summary"><meta name="twitter:site" content="https://twitter.com/drag137"><meta name="twitter:url" content="https://drag13.io/posts/typescript-tricks-utility-examples/index.html"><meta name="twitter:title" content="TypeScript Tips and Tricks - Utility Types With Examples"><meta name="twitter:description" content="In this article we will learn how to use utility types, create types based on objects or tupples, transform types and override properties in TypeScript without copy-paste "><meta name="og:site_name" content="Drag13 Dev Blog"><meta property="og:image" content="https://drag13.io/ts-utility.77a0cf5e.png"><meta name="twitter:image" content="https://drag13.io/ts-utility.77a0cf5e.png"><meta name="application-name" content="Drag13 programmer's blog"><meta name="author" content="Drag13"><meta name="robots" content="index follow"><meta name="application-name" content="Drag13 Dev Blog"><link rel="stylesheet" href="https://drag13.io/common.67e40877.css"><link rel="stylesheet" href="https://drag13.io/post.45f546f7.css"><link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://drag13.io/apple-touch-icon-144x144.f6d9dce4.png"><link rel="apple-touch-icon-precomposed" sizes="152x152" href="https://drag13.io/apple-touch-icon-152x152.5c0b4e01.png"><link rel="icon" type="image/png" href="https://drag13.io/favicon-32x32.2ff4c37a.png" sizes="32x32"><link rel="icon" type="image/png" href="https://drag13.io/favicon-16x16.60caff07.png" sizes="16x16"><link rel="manifest" href="https://drag13.io/manifest.webmanifest"><body><nav class="nav"><a class="link" href="/" title="Back to the main page">Home</a><div><a class="icon" href="https://github.com/Drag13" target="_blank" title="To GitHub"><svg height="32" viewBox="0 0 16 16" width="32" aria-hidden="true"><path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z"/></svg></a><a class="icon" href="https://twitter.com/drag137" target="_blank"><svg height="32" width="32" viewBox="0 0 24 24" aria-hidden="true" fill="rgba(29,161,242,1.00)"><path d="M23.643 4.937c-.835.37-1.732.62-2.675.733a4.67 4.67 0 002.048-2.578 9.3 9.3 0 01-2.958 1.13 4.66 4.66 0 00-7.938 4.25 13.229 13.229 0 01-9.602-4.868c-.4.69-.63 1.49-.63 2.342A4.66 4.66 0 003.96 9.824a4.647 4.647 0 01-2.11-.583v.06a4.66 4.66 0 003.737 4.568 4.692 4.692 0 01-2.104.08 4.661 4.661 0 004.352 3.234 9.348 9.348 0 01-5.786 1.995 9.5 9.5 0 01-1.112-.065 13.175 13.175 0 007.14 2.093c8.57 0 13.255-7.098 13.255-13.254 0-.2-.005-.402-.014-.602a9.47 9.47 0 002.323-2.41z"/></svg></a></div></nav><main class="main"><div class="content markdown-body"><article class="post"><h1>TypeScript Tips and Tricks - Utility Types With Examples</h1>
<p><a href="https://drag13.io/posts/typescript-tricks-utility-examples/index.html"><img src="https://drag13.io/ts-declarations.ff5bcc55.png" alt="typescript tips and trics declarations"></a></p>
<p>TypeScript is a very powerful language, however, it heavily relies on the types. And sometimes, you may found that you write more types than actual code. In this case, you should take a look into the Utility types that will help you to write fewer types and still keep your code type-safe.</p>
<p>Let's start from the simple example - imagine that you have a list of events produced by the application and a list of handlers for them. So you may write (don't do this way) something like this:</p>
<pre><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Action</span> <span class="token operator">=</span> <span class="token string">"move"</span> <span class="token operator">|</span> <span class="token string">"stop"</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function">handleAction</span><span class="token punctuation">(</span>action<span class="token operator">:</span> Action<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>action <span class="token operator">===</span> <span class="token string">"move"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"i am moving"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span>action <span class="token operator">===</span> <span class="token string">"stop"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"i am stopped"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>Suddenly, requirements changes (requirements always changing suddenly ðŸ˜€), and now you need to handle <code>beep</code> action. You update the Action type, but might forget to update <code>handleAction</code> function which will lead to a bug. However, with help of utility types, you can be protected from such type of failer:</p>
<pre><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">Action</span> <span class="token operator">=</span> <span class="token string">"move"</span> <span class="token operator">|</span> <span class="token string">"stop"</span> <span class="token operator">|</span> <span class="token string">"beep"</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> handlers<span class="token operator">:</span> Record<span class="token operator">&lt;</span>Action<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token keyword">void</span><span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">move</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"i am moving"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">stop</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"i am stopped"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">beep</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">"beeep!"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> <span class="token function-variable function">handlerAction</span> <span class="token operator">=</span> <span class="token punctuation">(</span>action<span class="token operator">:</span> Action<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> handlers<span class="token punctuation">[</span>action<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p>Now, when new action will come, you will be automatically notified that you need to extend your handlers. If you accidentally remove some code from handlers, you will be notified as well. Great TypeScript feature!</p>
<p>You can do the same trick with objects:</p>
<pre><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">User</span> <span class="token operator">=</span> <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span> age<span class="token operator">:</span> <span class="token builtin">number</span> <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">ValidationMap</span> <span class="token operator">=</span> Record<span class="token operator">&lt;</span><span class="token keyword">keyof</span> User<span class="token punctuation">,</span> <span class="token punctuation">(</span>user<span class="token operator">:</span> User<span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token builtin">boolean</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>

<span class="token keyword">const</span> validations<span class="token operator">:</span> ValidationMap <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">age</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> age <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> age <span class="token operator">&gt;</span> <span class="token number">21</span><span class="token punctuation">,</span>
  <span class="token function-variable function">name</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">{</span> name <span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> name <span class="token operator">!=</span> <span class="token keyword">null</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>This was done with the help of the <code>keyof</code> keyword. It extracts keys from the interface or type and creates another type. Simplifying it may look like this:</p>
<pre><code class="language-typescript"><span class="token keyword">interface</span> <span class="token class-name">IPerson</span> <span class="token operator">=</span> <span class="token punctuation">{</span>age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">,</span> name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token keyword">type</span> <span class="token class-name">PersonProps</span> <span class="token operator">=</span> <span class="token keyword">keyof</span> IPerson<span class="token punctuation">;</span> <span class="token comment">// 'age | name';</span>
</code></pre>
<p>This tip is very useful for the validation scenarios when you want to ensure that all properties of the object are handled.</p>
<p>If you want to know how to extract types from the array (or tuples), it's also easy, just don't forget to use <code>as const</code> statement:</p>
<pre><code class="language-typescript"><span class="token keyword">const</span> events <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"success"</span><span class="token punctuation">,</span> <span class="token string">"faile"</span><span class="token punctuation">]</span> <span class="token keyword">as</span> <span class="token keyword">const</span><span class="token punctuation">;</span>
<span class="token keyword">const</span> valueExtractors<span class="token operator">:</span> Record<span class="token operator">&lt;</span><span class="token keyword">typeof</span> roles<span class="token punctuation">[</span><span class="token builtin">number</span><span class="token punctuation">]</span><span class="token punctuation">,</span> Dispatcher<span class="token operator">&gt;</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">"success"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token function-variable function">faile</span><span class="token operator">:</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token function">dispatch</span><span class="token punctuation">(</span><span class="token string">"faile"</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>Another useful utility type, you might be already familiar with is <code>Partial&lt;TModel&gt;</code> type. It is very handy when you are filling a domain model from untrusted resources or do some null/undefined behavior testing. Imagine that you are fetching big objects that might be partially filled and want to avoid <code>Cannot read property XXX of null</code> type exception. In this case, you can use Partial type and TypeScript will automatically suggest you verify your data:</p>
<pre><code class="language-typescript"><span class="token comment">// This model we are using inside the application</span>
<span class="token keyword">type</span> <span class="token class-name">DomainUser</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  age<span class="token operator">:</span> <span class="token builtin">number</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">type</span> <span class="token class-name">UserDto</span> <span class="token operator">=</span> Partial<span class="token operator">&lt;</span>DomainUser<span class="token operator">&gt;</span><span class="token punctuation">;</span> <span class="token comment">// This model we expect to get from API</span>

<span class="token keyword">const</span> fetchUser <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> UserDto <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token function">fetchUser</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>age<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// Now, TypeScript is warning about the possible error and we now that check is needed</span>
</code></pre>
<p><code>Partial&lt;T&gt;</code> is a very useful utility type, however, it has an issue. It is not working with nested objects. You can use this code to write your own DeepPartial type:</p>
<pre><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">DeepPartial<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token operator">&gt;</span></span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span><span class="token constant">P</span> <span class="token keyword">in</span> <span class="token keyword">keyof</span> <span class="token constant">T</span><span class="token punctuation">]</span><span class="token operator">?</span><span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token class-name"><span class="token builtin">Array</span><span class="token operator">&lt;</span>infer <span class="token constant">U</span><span class="token operator">&gt;</span></span>
    <span class="token operator">?</span> <span class="token builtin">Array</span><span class="token operator">&lt;</span>DeepPartial<span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">&gt;&gt;</span>
    <span class="token operator">:</span> <span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span> <span class="token keyword">extends</span> <span class="token class-name">ReadonlyArray<span class="token operator">&lt;</span>infer <span class="token constant">U</span><span class="token operator">&gt;</span></span>
    <span class="token operator">?</span> ReadonlyArray<span class="token operator">&lt;</span>DeepPartial<span class="token operator">&lt;</span><span class="token constant">U</span><span class="token operator">&gt;&gt;</span>
    <span class="token operator">:</span> DeepPartial<span class="token operator">&lt;</span><span class="token constant">T</span><span class="token punctuation">[</span><span class="token constant">P</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre>
<p>The code seems a bit tricky but it uses only two technics - conditional types and inferring. Both of them will be covered in the next article.</p>
<p>Speaking about partial types, I can't ignore one more very helpful classes - <code>Omit&lt;TModel, TKeys&gt;</code>. It helps you to exclude or override some properties based on already created class:</p>
<pre><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">User</span> <span class="token operator">=</span> <span class="token punctuation">{</span>
  name<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  email<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span>
  sex<span class="token operator">:</span> NonExistedTypeFitsAll<span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>

<span class="token keyword">interface</span> <span class="token class-name">MultiEmailUser</span> <span class="token keyword">extends</span> <span class="token class-name">Omit<span class="token operator">&lt;</span>User<span class="token punctuation">,</span> <span class="token string">"email"</span><span class="token operator">&gt;</span></span> <span class="token punctuation">{</span>
  email<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<p>As you can see, using this technique you don't need to copy-paste user type. You just transform on type into something that fits better. If you need to omit more properties, just use Union type here:</p>
<pre><code class="language-typescript"><span class="token keyword">type</span> <span class="token class-name">CuttedUser</span> <span class="token operator">=</span> Omit<span class="token operator">&lt;</span>User<span class="token punctuation">,</span> <span class="token string">"email"</span> <span class="token operator">|</span> <span class="token string">"email"</span><span class="token operator">&gt;</span><span class="token punctuation">;</span>
</code></pre>
<p>That is all. If you want to know more about TypeScript utility types - visit the <a href="https://www.typescriptlang.org/docs/handbook/utility-types.html">TypeScript handbook</a>.</p>
<p>See you next time!</p>
<p class="tag">20.09.2020 #typescript, #utilitytypes</p></article></div></main><footer class="footer"><a href="https://github.com/Drag13/drag13.github.io/blob/development/LICENSE" target="_blank" title="License">2020 MIT by Drag13</a></footer></body></html>